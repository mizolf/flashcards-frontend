<div class="login-container">
  <div class="login-card">
    @if (isLoginMode) {
      <h1 class="title">Prijavite se na vaš račun</h1>
    }
    @else {
      <h1 class="title">Stvorite novi račun</h1>
    }

    <div class="flex justify-center items-center w-full mb-4">
      <p-selectbutton
        [options]="modeOptions"
        [(ngModel)]="selectedMode"
        (ngModelChange)="onModeChange()"
        optionLabel="label"
        optionValue="value"
        aria-labelledby="mode-selector" />
    </div>

    <!-- Login forma -->
    @if (isLoginMode && !showVerification) {
        <form [formGroup]="loginForm" class="form" >
          <div class="field">
            <label for="login-email">E-mail adresa</label>
            <input
              pInputText
              id="login-email"
              type="email"
              placeholder="Unesite vašu e-mail adresu"
              class="input-field"
              formControlName="email" />
          </div>
        
          <div class="field">
            <label for="login-password">Lozinka</label>
            <p-password formControlName="password" feedback="false" [toggleMask]="true" styleClass="password-input" placeholder="Unesite vašu lozinku" />
          </div>
    
          <a href="#" class="forgot-link">Zaboravljena lozinka?</a>
    
          <button
            pButton
            type="submit"
            label="Prijavi se"
            class="submit-btn"
            [loading]="loading"
            [disabled]="loginForm.invalid"
            (click)="login()">
          </button>

          @if (loginForm.get('email')?.invalid && loginForm.get('email')?.touched) {
            <small class="error">Unesite valjanu e-mail adresu</small>
          }
    
          <div class="divider">
            <span>Ili se prijavite putem</span>
          </div>
    
          <div class="social-buttons">
            <button type="button" class="social-btn google">
              <i class="pi pi-google"></i>
            </button>
            <button type="button" class="social-btn facebook">
              <i class="pi pi-facebook"></i>
            </button>
          </div>
        </form>
    }

    <!-- Register forma -->
    @if (!isLoginMode && !showVerification) {
        <form [formGroup]="registerForm" class="form" >
          <div class="field">
            <label for="register-username">Korisničko ime</label>
            <input
              pInputText
              id="register-username"
              type="text"
              placeholder="Unesite korisničko ime"
              class="input-field"
              formControlName="username" />
          </div>
    
          <div class="field">
            <label for="register-email">E-mail adresa</label>
            <input
              pInputText
              id="register-email"
              type="email"
              placeholder="Unesite vašu e-mail adresu"
              class="input-field"
              formControlName="email" />
          </div>
    
          <div class="field">
            <label for="register-password">Lozinka</label>
            <p-password formControlName="password" feedback="false" [toggleMask]="true" placeholder="Unesite vašu lozinku" styleClass="password-input" />
          </div>
    
          <div class="field">
            <label for="confirm-password">Potvrdite lozinku</label>
            <p-password
              id="confirm-password"
              placeholder="Potvrdite vašu lozinku"
              [toggleMask]="true"
              [feedback]="false"
              styleClass="password-input"
              formControlName="confirmPassword">
            </p-password>
          </div>
    
          <button
            pButton
            type="submit"
            label="Registriraj se"
            class="submit-btn"
            [loading]="loading"
            [disabled]="registerForm.invalid"
            (click)="register()">
          </button>
    
          <div class="divider">
            <span>Ili se prijavite putem</span>
          </div>
    
          <div class="social-buttons">
            <button type="button" class="social-btn google">
              <i class="pi pi-google"></i>
            </button>
            <button type="button" class="social-btn facebook">
              <i class="pi pi-facebook"></i>
            </button>
          </div>
        </form>
    }

    @if (showVerification) {
        <form class="form">
          <div class="field">
            <label for="verification-code">Verifikacijski kod</label>
            <input
              pInputText
              id="verification-code"
              type="text"
              placeholder="Unesite 6-cifreni kod"
              class="input-field verification-input"
              maxlength="6" />
          </div>
    
          <button
            pButton
            type="submit"
            label="Potvrdi"
            class="submit-btn"
            [loading]="false">
          </button>
    
          <div class="text-center mt-3">
            <p class="resend-text">
              Niste primili kod?
              <a href="#" class="resend-link">Pošalji ponovo</a>
            </p>
          </div>
        </form>
    }
  </div>
</div>
